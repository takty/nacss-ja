window.NACSS=window.NACSS||{},function(e){function n(e,n){for(const t of Array.from(e.getElementsByTagName("span")))if(d(t,n.styleKerning)){const e=document.createDocumentFragment();for(const n of Array.from(t.childNodes))e.appendChild(n);t.parentNode.replaceChild(e,t)}}function t(e,n,o){for(const r of Array.from(e.childNodes))1===r.nodeType?d(r,o.styleDisabled)||t(r,n,o):3===r.nodeType&&i(r,n,o)}function i(e,n,t){const[i,r]=function(e){const n=e.parentNode;if(!(n instanceof HTMLElement))return[!1,!1];const t=getComputedStyle(n).display;if(!t.includes("inline"))return o(e);if("inline-block"===t){if(1!==n.childNodes.length)return o(e);const t=n.parentNode;if(t){if(!getComputedStyle(t).display.includes("inline"))return o(n,!0)}}return[!1,!1]}(e);let s=e.textContent;i&&(s=function(e){const n=e.match(/^[\n\r\t ]*(\u3000*)/);return(n&&1<n.length?n[1]:"")+e.replace(/^\s+/g,"")}(s)),r&&(s=function(e){return e.replace(/\s+$/g,"")}(s)),s=function(e){return e.replace(/([^\x01-\x7E\xA1-\xDF]+)([\t\n]+|[ \f\n\r\t\v\u00a0\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\ufeff]{2})([^\x01-\x7E\xA1-\xDF]+)/g,((e,n,t,i)=>n+i))}(s);let u="";if(e.nextSibling&&1===e.nextSibling.nodeType&&"inline"===getComputedStyle(e.nextSibling).display&&(u=e.nextSibling.innerText),!e.nextSibling&&e.parentNode.nextSibling){const n=e.parentNode.nextSibling;if(1===n.nodeType){getComputedStyle(n).display.includes("inline")&&(u=n.innerText)}3===n.nodeType&&(u=n.textContent)}const a=l(s,n,i,u,t.doAssignAttribute);if(a.length){const n=c(s,a,t);e.parentNode.replaceChild(n,e)}}function o(e,n=!1){return[n?s(e.previousSibling):r(e.previousSibling),r(e.nextSibling)]}function r(e){return null===e||e instanceof HTMLElement&&("BR"===e.tagName||!getComputedStyle(e).display.includes("inline"))}function s(e){for(;;){if(null===e)return!0;if(1===e.nodeType)return"BR"===e.tagName||!getComputedStyle(e).display.includes("inline");if(3===e.nodeType&&!e.textContent.trim())return!0;e=e.previousSibling}}function l(e,n,t,i,o){let r=Array.from(e);const s=[];i.length&&(r=r.concat(Array.from(i)));let l=0;for(let e=0;e<r.length;e+=1){const i=r[e],c=r[e+1];let u="";""!==i&&""!==c&&n.has(i+c)&&(u=o?"s":"letter-spacing:-0.4em;"),0===e&&t&&""!==i&&n.has(i)&&(u+=o?"h":"margin-left:-0.4em"),u.length?(l&&(s.push(l),l=0),s.push(u)):l+=1}return s.length&&l&&s.push(l),s}function c(e,n,t){const i=Array.from(e),o=document.createDocumentFragment();let r=0;for(const e of n)if(Number.isInteger(e)){const n=document.createTextNode(i.slice(r,r+e).join(""));o.appendChild(n),r+=e}else{const n=document.createElement("span");n.appendChild(document.createTextNode(i.slice(r,r+1).join(""))),e.length<=2?f(n,t.styleKerning,!0,e):n.style=e,o.appendChild(n),r+=1}return o}const u=new Set;{function a(e,n,t){for(const i of n)for(const n of t)e.add(i+n)}a(u,"、，。．・｜：　","「『（［｛〈《【〔"),a(u,"」』）］｝〉》】〕","、，。．・｜：,."),a(u,"」』）］｝〉》】〕","「『（［｛〈《【〔"),a(u,"「『（［｛〈《【〔","「『（［｛〈《【〔"),a(u,"」』）］｝〉》】〕","」』）］｝〉》】〕"),function(e,n){for(const t of n)e.add(t)}(u,"「『（［｛〈《【〔")}function d(e,n){const t=n.substr(1);return n.startsWith(":")?void 0!==e.dataset[t]:e.classList.contains(t)}function f(e,n,t=!0,i=""){const o=n.substr(1);n.startsWith(":")?t?e.dataset[o]=i:delete e.dataset[o]:t?e.classList.add([o,i].join("-")):e.classList.remove([o,i].join("-"))}e.jaKerning=function(e,i={}){if(0!==e.length){i=Object.assign({styleKerning:":ncKern",styleDisabled:":ncNoKerning",doAssignAttribute:!0,doDisableOnSelecting:!0},i);for(const o of e)if(t(o,u,i),i.doAssignAttribute&&i.doDisableOnSelecting){const e=function(){n(o,i),o.removeEventListener("selectstart",e)};o.addEventListener("selectstart",e)}}},e.jaApplyKerning=function(e,n={}){n=Object.assign({styleKerning:":ncKern",styleDisabled:":ncNoKerning",doAssignAttribute:!0},n);const t=l(e,u,!1,n.doAssignAttribute);return t.length?c(e,t,n):null}}(window.NACSS);
//# sourceMappingURL=ja-kerning.min.js.map