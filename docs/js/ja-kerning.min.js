"use strict";window.NACSS=window.NACSS||{},window.NACSS.ja=window.NACSS.ja||{},(e=>{function n(e,n){const t=n.substr(1);return n.startsWith(":")?void 0!==e.dataset[t]:e.classList.contains(t)}function t(e,n,t=!0,i=""){const o=n.substr(1);if(n.startsWith(":"))t?e.dataset[o]=i:delete e.dataset[o];else{const n=[o,i].join("-");t?e.classList.add(n):e.classList.remove(n)}}function i(e,t){for(const i of[...e.getElementsByTagName("span")])if(n(i,t.styleKerning)){const e=document.createDocumentFragment();for(const n of[...i.childNodes])e.appendChild(n);i.parentNode.replaceChild(e,i)}}function o(e,t,i){for(const r of[...e.childNodes])1===r.nodeType?n(r,i.styleDisabled)||i.ignoredTags.includes(r.tagName)||o(r,t,i):3===r.nodeType&&s(r,t,i)}function s(e,n,t){const[i,o]=function(e){const n=e.parentNode;if(!(n instanceof HTMLElement))return[!1,!1];const t=getComputedStyle(n).display;if(!t.includes("inline"))return r(e);if("inline-block"===t){if(1!==n.childNodes.length)return r(e);const t=n.parentNode;if(t){if(!getComputedStyle(t).display.includes("inline"))return r(n,!0)}}return[!1,!1]}(e);let s=e.textContent;i&&(s=function(e){const n=e.match(/^[\n\r\t ]*(\u3000*)/);return(n&&1<n.length?n[1]:"")+e.replace(/^\s+/g,"")}(s)),o&&(s=function(e){return e.replace(/\s+$/g,"")}(s)),s=function(e){return e.replace(/([^\x01-\x7E\xA1-\xDF]+)([\t\n]+|[ \f\n\r\t\v\u00a0\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\ufeff]{2})([^\x01-\x7E\xA1-\xDF]+)/g,((e,n,t,i)=>n+i))}(s);let l="";if(e.nextSibling&&1===e.nextSibling.nodeType&&"inline"===getComputedStyle(e.nextSibling).display&&(l=e.nextSibling.innerText),!e.nextSibling&&e.parentNode.nextSibling){const n=e.parentNode.nextSibling;if(1===n.nodeType){getComputedStyle(n).display.includes("inline")&&(l=n.innerText)}3===n.nodeType&&(l=n.textContent)}const c=a(s,n,i,l,t.doAssignAttribute);if(c.length){const n=d(s,c,t);e.parentNode.replaceChild(n,e)}}function r(e,n=!1){return[n?c(e.previousSibling):l(e.previousSibling),l(e.nextSibling)]}function l(e){return null===e||e instanceof HTMLElement&&("BR"===e.tagName||!getComputedStyle(e).display.includes("inline"))}function c(e){for(;;){if(null===e)return!0;if(1===e.nodeType)return"BR"===e.tagName||!getComputedStyle(e).display.includes("inline");if(3===e.nodeType&&!e.textContent.trim())return!0;e=e.previousSibling}}function a(e,n,t,i,o){let s=[...e];const r=[];i.length&&(s=s.concat([...i]));let l=0;for(let e=0;e<s.length;e+=1){const i=s[e],c=s[e+1];let a="";""!==i&&""!==c&&n.has(i+c)&&(a=o?"s":"letter-spacing:-0.4em;"),0===e&&t&&""!==i&&n.has(i)&&(a+=o?"h":"margin-left:-0.4em"),a.length?(l&&(r.push(l),l=0),r.push(a)):l+=1}return r.length&&l&&r.push(l),r}function d(e,n,i){const o=[...e],s=document.createDocumentFragment();let r=0;for(const e of n)if(Number.isInteger(e)){const n=document.createTextNode(o.slice(r,r+e).join(""));s.appendChild(n),r+=e}else{const n=document.createElement("span");n.appendChild(document.createTextNode(o.slice(r,r+1).join(""))),e.length<=2?t(n,i.styleKerning,!0,e):n.style=e,s.appendChild(n),r+=1}return s}const u=new Set;{function g(e,n,t){for(const i of n)for(const n of t)e.add(i+n)}function f(e,n){for(const t of n)e.add(t)}g(u,"、，。．・｜：　","「『（［｛〈《【〔"),g(u,"」』）］｝〉》】〕","、，。．・｜：,."),g(u,"」』）］｝〉》】〕","「『（［｛〈《【〔"),g(u,"「『（［｛〈《【〔","「『（［｛〈《【〔"),g(u,"」』）］｝〉》】〕","」』）］｝〉》】〕"),f(u,"「『（［｛〈《【〔")}e.applyKerning=function(e,n={}){if(0!==e.length&&!CSS.supports("text-spacing-trim","normal")){(n=Object.assign({styleKerning:":ncKern",styleDisabled:":ncNoKerning",ignoredTags:["PRE"],doAssignAttribute:!0,doDisableOnSelecting:!0},n)).ignoredTags=n.ignoredTags.map((e=>e.toUpperCase()));for(const t of e)if(o(t,u,n),n.doAssignAttribute&&n.doDisableOnSelecting){const e=()=>{i(t,n),t.removeEventListener("selectstart",e)};t.addEventListener("selectstart",e)}}},e.applyKerningToString=function(e,n={}){n=Object.assign({styleKerning:":ncKern",styleDisabled:":ncNoKerning",doAssignAttribute:!0},n);const t=a(e,u,!1,n.doAssignAttribute);return t.length?d(e,t,n):null}})(window.NACSS.ja);
//# sourceMappingURL=ja-kerning.min.js.map