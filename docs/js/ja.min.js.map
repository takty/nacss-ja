{"version":3,"sources":["ja.js"],"names":["window","NS","hasClass","tar","cls","key","substr","startsWith","undefined","dataset","classList","contains","setClass","enabled","val","add","join","remove","removeWhiteSpacesBetweenZenChars","str","replace","match","g1","d","g2","removeKerning","elm","opts","s","Array","from","getElementsByTagName","styleKerning","df","document","createDocumentFragment","c","childNodes","appendChild","parentNode","replaceChild","kernElement","dict","nodeType","styleDisabled","kernTextNode","tn","isHead","isTail","p","HTMLElement","pd","getComputedStyle","display","includes","isSiblingBlock","length","pp","isEnd","textContent","mzs","removeHeadWhiteSpaces","removeTailWhiteSpaces","nt","nextSibling","innerText","parentNext","ks","getKerning","doAssignAttribute","f","createFragment","n","greedy","isPreviousBlockGreedy","previousSibling","isBlock","tagName","trim","nextNodeText","assignAttr","strArray","ret","concat","l","i","c0","c1","a","has","push","k","Number","isInteger","createTextNode","slice","createElement","style","Set","addPairs","cs0","cs1","head","h","addSolos","jaKerning","ts","Object","assign","doDisableOnSelecting","t","removeEventListener","addEventListener","jaApplyKerning","CHAR_TYPES","CHAR_PATS","S","E","I","K","H","N","PAIRS","II","KK","HH","HI","NN","OO","ON","NO","PARTICLE_A","split","PARTICLE_H","ja","PRE_KANJI","ADNOMINAL","segmentElement","fs","outerHTML","apply","innerHTML","text","parts","tP","word","tWordHead","substring","getCharType","ws","newWs","wP","w","concatParticle","concatStopChar","concatMeasureWord","pres","swP","pre","endsWith","len","splitKanjiPrefix","pns","pn","splitTailAdnominal","reB","reA","sb","exec","sa","before","after","wrapWithSpan","test","jaSegmenterOld","jaApplySegmenterOld","removeSegment","sty","styleSegment","className","segmentTextNode","getSegment","IW","AW","AI1","PRE_NUM","createCharTypeArray","fill","t0","t1","weightByCharTypes","strA","phrases","ph","phA","phL","bgn","idx0","indexOfArray","idx1","divideByPhrases","concatByPhrases","al","divideByCombinedPhrases","weightByPhrases","CLS_ALL","CLS_WO_KANJI","CHAR_PATTERNS","TT","NH","NK","NI","prevCts","nextCts","prevW","nextW","tsL","array","searchElement","fromIndex","j","temp","idx","appendPhrase","isOriginalCharPhrase","isOrig","e","end","jaSegmenter","jaApplySegmenter"],"mappings":"AAUAA,OAAM,MAAYA,OAAM,OAAa,GAGrC,SAAWC,GAwwBV,SAASC,EAASC,EAAKC,GACtB,MAAMC,EAAMD,EAAIE,OAAO,GACvB,OAAIF,EAAIG,WAAW,UACUC,IAArBL,EAAIM,QAAQJ,GAEZF,EAAIO,UAAUC,SAASN,GAIhC,SAASO,EAAST,EAAKC,EAAKS,GAAU,EAAMC,EAAM,IACjD,MAAMT,EAAMD,EAAIE,OAAO,GACnBF,EAAIG,WAAW,KACdM,EACHV,EAAIM,QAAQJ,GAAOS,SAEZX,EAAIM,QAAQJ,GAGhBQ,EACHV,EAAIO,UAAUK,IAAI,CAACV,EAAKS,GAAKE,KAAK,MAElCb,EAAIO,UAAUO,OAAO,CAACZ,EAAKS,GAAKE,KAAK,MAyBxC,SAASE,EAAiCC,GAGzC,OAAOA,EAAIC,QAAQ,sIAAsI,CAACC,EAAOC,EAAIC,EAAGC,IAAOF,EAAKE,KAvzBrL,WAiCC,SAASC,EAAcC,EAAKC,GAC3B,IAAK,MAAMC,KAAKC,MAAMC,KAAKJ,EAAIK,qBAAqB,SACnD,GAAI7B,EAAS0B,EAAGD,EAAKK,cAAe,CACnC,MAAMC,EAAKC,SAASC,yBACpB,IAAK,MAAMC,KAAKP,MAAMC,KAAKF,EAAES,YAC5BJ,EAAGK,YAAYF,GAEhBR,EAAEW,WAAWC,aAAaP,EAAIL,IAuBjC,SAASa,EAAYf,EAAKgB,EAAMf,GAC/B,IAAK,MAAMS,KAAKP,MAAMC,KAAKJ,EAAIW,YACX,IAAfD,EAAEO,SACAzC,EAASkC,EAAGT,EAAKiB,gBAAgBH,EAAYL,EAAGM,EAAMf,GAClC,IAAfS,EAAEO,UACZE,EAAaT,EAAGM,EAAMf,GAKzB,SAASkB,EAAaC,EAAIJ,EAAMf,GAC/B,MAAOoB,EAAQC,GA+BhB,SAAeF,GACd,MAAMG,EAAIH,EAAGP,WACb,KAAMU,aAAaC,aAAc,MAAO,EAAC,GAAO,GAChD,MAAMC,EAAKC,iBAAiBH,GAAGI,QAC/B,IAAKF,EAAGG,SAAS,UAChB,OAAOC,EAAeT,GAEvB,GAAW,iBAAPK,EAAuB,CAC1B,GAA4B,IAAxBF,EAAEZ,WAAWmB,OAChB,OAAOD,EAAeT,GAEvB,MAAMW,EAAKR,EAAEV,WACb,GAAIkB,EAAI,CAEP,IADYL,iBAAiBK,GAAIJ,QACxBC,SAAS,UACjB,OAAOC,EAAeN,GAAG,IAI5B,MAAO,EAAC,GAAO,GAlDUS,CAAMZ,GAE/B,IAAI3B,EAAM2B,EAAGa,YACTZ,IAAQ5B,EA6tBd,SAA+BA,GAC9B,MAAMyC,EAAMzC,EAAIE,MAAM,wBAEtB,OADYuC,GAAO,EAAIA,EAAIJ,OAAUI,EAAI,GAAK,IAClCzC,EAAIC,QAAQ,QAAS,IAhuBdyC,CAAsB1C,IACpC6B,IAAQ7B,EAkuBd,SAA+BA,GAC9B,OAAOA,EAAIC,QAAQ,QAAS,IAnuBT0C,CAAsB3C,IACxCA,EAAMD,EAAiCC,GAEvC,IAAI4C,EAAK,GAIT,GAHIjB,EAAGkB,aAA2C,IAA5BlB,EAAGkB,YAAYrB,UAA+D,WAA7CS,iBAAiBN,EAAGkB,aAAaX,UACvFU,EAAKjB,EAAGkB,YAAYC,YAEhBnB,EAAGkB,aAAelB,EAAGP,WAAWyB,YAAa,CACjD,MAAME,EAAapB,EAAGP,WAAWyB,YACjC,GAA4B,IAAxBE,EAAWvB,SAAgB,CAClBS,iBAAiBc,GAAYb,QACjCC,SAAS,YAChBS,EAAKG,EAAWD,WAGU,IAAxBC,EAAWvB,WACdoB,EAAKG,EAAWP,aAIlB,MAAMQ,EAAKC,EAAWjD,EAAKuB,EAAMK,EAAQgB,EAAIpC,EAAK0C,mBAClD,GAAIF,EAAGX,OAAQ,CACd,MAAMc,EAAIC,EAAepD,EAAKgD,EAAIxC,GAClCmB,EAAGP,WAAWC,aAAa8B,EAAGxB,IA0BhC,SAASS,EAAeiB,EAAGC,GAAS,GACnC,MAAO,CAACA,EAASC,EAAsBF,EAAEG,iBAAmBC,EAAQJ,EAAEG,iBAAkBC,EAAQJ,EAAER,cAGnG,SAASY,EAAQJ,GAChB,OAAU,OAANA,GACEA,aAAatB,cACD,OAAdsB,EAAEK,UACEzB,iBAAiBoB,GAAGnB,QAAQC,SAAS,WAG9C,SAASoB,EAAsBF,GAC9B,OAAa,CACZ,GAAU,OAANA,EAAY,OAAO,EACvB,GAAmB,IAAfA,EAAE7B,SACL,MAAkB,OAAd6B,EAAEK,UACEzB,iBAAiBoB,GAAGnB,QAAQC,SAAS,UAE9C,GAAmB,IAAfkB,EAAE7B,WACA6B,EAAEb,YAAYmB,OAAQ,OAAO,EAEnCN,EAAIA,EAAEG,iBAQR,SAASP,EAAWjD,EAAKuB,EAAMK,EAAQgC,EAAcC,GACpD,IAAIC,EAAWpD,MAAMC,KAAKX,GAC1B,MAAM+D,EAAM,GAERH,EAAavB,SAChByB,EAAWA,EAASE,OAAOtD,MAAMC,KAAKiD,KAEvC,IAAIK,EAAI,EAER,IAAK,IAAIC,EAAI,EAAGA,EAAIJ,EAASzB,OAAQ6B,GAAK,EAAG,CAC5C,MAAMC,EAAKL,EAASI,GACdE,EAAKN,EAASI,EAAI,GAExB,IAAIG,EAAI,GACG,KAAPF,GAAoB,KAAPC,GAAa7C,EAAK+C,IAAIH,EAAKC,KAC3CC,EAAIR,EAAa,IAAM,0BAEd,IAANK,GAAWtC,GAAiB,KAAPuC,GAAa5C,EAAK+C,IAAIH,KAC9CE,GAAKR,EAAa,IAAM,sBAErBQ,EAAEhC,QACD4B,IACHF,EAAIQ,KAAKN,GACTA,EAAI,GAELF,EAAIQ,KAAKF,IAETJ,GAAK,EAIP,OADIF,EAAI1B,QAAU4B,GAAGF,EAAIQ,KAAKN,GACvBF,EAGR,SAASX,EAAepD,EAAKgD,EAAIxC,GAChC,MAAMsD,EAAWpD,MAAMC,KAAKX,GACtBmD,EAAIpC,SAASC,yBACnB,IAAIkD,EAAI,EACR,IAAK,MAAMM,KAAKxB,EACf,GAAIyB,OAAOC,UAAUF,GAAI,CACxB,MAAMnB,EAAItC,SAAS4D,eAAeb,EAASc,MAAMV,EAAGA,EAAIM,GAAG3E,KAAK,KAChEsD,EAAEhC,YAAYkC,GACda,GAAKM,MACC,CACN,MAAMnB,EAAItC,SAAS8D,cAAc,QACjCxB,EAAElC,YAAYJ,SAAS4D,eAAeb,EAASc,MAAMV,EAAGA,EAAI,GAAGrE,KAAK,MAChE2E,EAAEnC,QAAU,EACf5C,EAAS4D,EAAG7C,EAAKK,cAAc,EAAM2D,GAErCnB,EAAEyB,MAAQN,EAEXrB,EAAEhC,YAAYkC,GACda,GAAK,EAGP,OAAOf,EAOR,MAAM5B,EAAO,IAAIwD,IACjB,CAQC,SAASC,EAASzD,EAAM0D,EAAKC,GAC5B,IAAK,MAAMf,KAAMc,EAChB,IAAK,MAAMb,KAAMc,EAChB3D,EAAK3B,IAAIuE,EAAKC,GAVjBY,EAASzD,EAAM,WAAY,aAC3ByD,EAASzD,EAAM,YAAa,aAC5ByD,EAASzD,EAAM,YAAa,aAC5ByD,EAASzD,EAAM,YAAa,aAC5ByD,EAASzD,EAAM,YAAa,aAW5B,SAAkBA,EAAM4D,GACvB,IAAK,MAAMC,KAAKD,EACf5D,EAAK3B,IAAIwF,GAZXC,CAAS9D,EAAM,aAiBhBzC,EAAGwG,UAvOH,SAAoBC,EAAI/E,EAAO,IAC9B,GAAkB,IAAd+E,EAAGlD,OAAP,CAEA7B,EAAOgF,OAAOC,OAAO,CACpB5E,aAAsB,UACtBY,cAAsB,eACtByB,mBAAsB,EACtBwC,sBAAsB,GACpBlF,GAEH,IAAK,MAAMmF,KAAKJ,EAEf,GADAjE,EAAYqE,EAAGpE,EAAMf,GACjBA,EAAK0C,mBAAqB1C,EAAKkF,qBAAsB,CACxD,MAAMvC,EAAI,WACT7C,EAAcqF,EAAGnF,GACjBmF,EAAEC,oBAAoB,cAAezC,IAEtCwC,EAAEE,iBAAiB,cAAe1C,MAuNrCrE,EAAGgH,eAtMH,SAAe9F,EAAKQ,EAAO,IAC1BA,EAAOgF,OAAOC,OAAO,CACpB5E,aAAmB,UACnBY,cAAmB,eACnByB,mBAAmB,GACjB1C,GAEH,MAAMwC,EAAKC,EAAWjD,EAAKuB,GAAM,EAAOf,EAAK0C,mBAC7C,OAAIF,EAAGX,OACCe,EAAepD,EAAKgD,EAAIxC,GAEzB,MAxDT,GAsPA,WAWC,MAAMuF,EAAa,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,KACvCC,EAAY,CACjBC,EAAG,oBACHC,EAAG,6BACHC,EAAG,UACHC,EAAG,eACHC,EAAG,aACHC,EAAG,aAEEC,EAAQ,CAAE,KAAM,EAAGC,GAAM,EAAGC,GAAM,EAAGC,GAAM,EAAGC,GAAM,EAAGC,GAAM,EAAGC,GAAM,EAAGC,GAAM,EAAGC,GAAM,GACxFC,EAAa,8JAA8JC,MAAM,KACjLC,EAAa,GACnB,IAAK,MAAMC,KAAMH,EAAYE,EAAWC,IAAM,EAC9C,MAAMC,EAAY,MAAMH,MAAM,KACxBI,EAAY,qJAAqJJ,MAAM,KAU7K,SAASK,EAAe/G,GACvB,MAAMoB,EAAKpB,EAAImD,QACT6D,EAAK,GAEX,IAAK,MAAMtG,KAAKP,MAAMC,KAAKJ,EAAIW,YACX,IAAfD,EAAEO,UACL8F,EAAerG,GACfsG,EAAGhD,KAAKtD,EAAEuG,YACe,IAAfvG,EAAEO,UACZ+F,EAAGhD,KAAKkD,EAAMxG,EAAEuB,YAAab,IAG/BpB,EAAImH,UAAYH,EAAG1H,KAAK,IAGzB,SAAS4H,EAAME,EAAMhG,GACpB,IAAIiG,EAAQ,GACRC,EAAK,GACLC,EAAO,GACPC,EAAY,GAEhB,IAAK,IAAI7D,EAAI,EAAGiC,EAAIwB,EAAKtF,OAAQ6B,EAAIiC,EAAGjC,GAAK,EAAG,CAC/C,MAAMjD,EAAI0G,EAAKK,UAAU9D,EAAGA,EAAI,GAC1ByB,EAAIsC,EAAYhH,GAClBsF,EAAMsB,EAAKlC,IAAMY,EAAM,IAAMZ,IAAMY,EAAMsB,EAAK,MACjDC,GAAQ7G,EACJ6G,IAAS7G,IAAG8G,EAAYpC,KAExB,EAAImC,EAAKzF,QAAQuF,EAAMrD,KAAK,CAACuD,EAAMC,EAAWF,IAClDC,EAAO7G,EACP8G,EAAYpC,GAEbkC,EAAKlC,EASN,OAPI,EAAImC,EAAKzF,QAAQuF,EAAMrD,KAAK,CAACuD,EAAMC,EAAWF,IAElDD,EASD,SAAwBM,GACvB,MAAMC,EAAQ,GACd,IAAIC,EAAK,KAET,IAAK,MAAMC,KAAKH,EACXE,GAAMlB,EAAWmB,EAAE,KACtBD,EAAG,IAAMC,EAAE,GACXD,EAAG,GAAKC,EAAE,KAEVF,EAAM5D,KAAK8D,GACXD,EAAKC,GAGP,OAAOF,EAtBCG,CAAeV,GACvBA,EAwBD,SAAwBM,GACvB,MAAMC,EAAQ,GACd,IAAIC,EAAK,KAET,IAAK,MAAMC,KAAKH,EACXE,GAAe,MAATC,EAAE,IACXD,EAAG,IAAMC,EAAE,GACXD,EAAG,GAAKC,EAAE,KAEVF,EAAM5D,KAAK8D,GACXD,EAAKC,GAGP,OAAOF,EArCCI,CAAeX,GACvBA,EAuCD,SAA2BM,GAC1B,MAAMC,EAAQ,GACd,IAAIC,EAAK,KAET,IAAK,MAAMC,KAAKH,EACXE,GAAgB,MAAVA,EAAG,IACZA,EAAG,IAAMC,EAAE,GACXD,EAAG,GAAKC,EAAE,KAEVF,EAAM5D,KAAK8D,GACXD,EAAKC,GAGP,OAAOF,EApDCK,CAAkBZ,GAC1BA,EAsDD,SAA0BM,EAAIO,GAC7B,GAAIP,EAAG7F,QAAU,EAAG,OAAO6F,EAE3B,IAAK,IAAIhE,EAAI,EAAGiC,EAAI+B,EAAG7F,OAAQ6B,EAAIiC,EAAGjC,GAAK,EAAG,CAC7C,MAAMmE,EAAIH,EAAGhE,GAAIkE,EAAKF,EAAGhE,EAAI,GAAIwE,EAAMN,EAAG,GAC1C,GAAa,MAATC,EAAE,GAEN,IAAK,MAAMM,KAAOF,EACjB,GAAIC,EAAIE,SAASD,GAAM,CACtB,MAAME,EAAMF,EAAItG,OAChB+F,EAAG,GAAKM,EAAIvJ,OAAO,EAAGuJ,EAAIrG,OAASwG,GACnCT,EAAG,GAAKH,EAAYG,EAAG,GAAGA,EAAG,GAAG/F,OAAS,IACzCgG,EAAE,GAAKM,EAAMN,EAAE,GACfA,EAAE,GAAK,KAIV,OAAOH,EAvECY,CAAiBlB,EAAOR,GAChCQ,EAyED,SAA4BM,EAAIa,GAC/B,MAAMZ,EAAQ,GAEd,IAAK,MAAME,KAAKH,EAAI,CACnB,IAAIjB,GAAQ,EACZ,IAAK,MAAM+B,KAAMD,EAChB,GAAIV,EAAE,GAAGO,SAASI,GAAK,CACtBX,EAAE,GAAKA,EAAE,GAAGlJ,OAAO,EAAGkJ,EAAE,GAAGhG,OAAS2G,EAAG3G,QACvC8F,EAAM5D,KAAK8D,GACXF,EAAM5D,KAAK,CAACyE,EAAI,IAAK,MACrB/B,GAAQ,EACR,MAGEA,GACJkB,EAAM5D,KAAK8D,GAEZ,OAAOF,EA1FCc,CAAmBrB,EAAOP,GACb,IAAjBO,EAAMvF,QAAkBV,GAAa,SAAPA,EA4FnC,SAAsBuG,GACrB,MAAMgB,EAAM,MACNC,EAAM,MACZ,IAAIpF,EAAM,GAEV,IAAK,MAAMsE,KAAKH,EACf,GAAa,MAATG,EAAE,IAAuB,MAATA,EAAE,GAAY,CACjC,MAAMe,EAAKF,EAAIG,KAAKhB,EAAE,IAChBiB,EAAKH,EAAIE,KAAKhB,EAAE,IAChBkB,EAAiB,OAAPH,EAAeA,EAAG,GAAK,GACjCI,EAAiB,OAAPF,EAAeA,EAAG,GAAK,GAEvCvF,GAAOwF,EAAS,SAAWlB,EAAE,GAAK,UAAYmB,OAE9CzF,GAAOsE,EAAE,GAGX,OAAOtE,EA5GA0F,CAAa7B,GADqCD,EAgH1D,SAASM,EAAYhH,GACpB,IAAK,MAAM0E,KAAKI,EAAY,CAE3B,GADUC,EAAUL,GACd+D,KAAKzI,GAAI,OAAO0E,EAEvB,MAAO,IAGR7G,EAAG6K,eAzKH,SAAoBpE,GACnB,IAAK,MAAMI,KAAKJ,EAAI+B,EAAe3B,IAyKpC7G,EAAG8K,oBAAsBnC,EArM1B,GAwMA,WAgCC,SAASoC,EAActJ,EAAKC,GAC3B,MAAMsJ,EAAMtJ,EAAKuJ,aACjB,IAAK,MAAMtJ,KAAKC,MAAMC,KAAKJ,EAAIK,qBAAqB,SACnD,GAAoB,IAAfkJ,EAAIzH,QAAgC,KAAhB5B,EAAEuJ,WAAqBjL,EAAS0B,EAAGqJ,GAAM,CACjE,MAAMhJ,EAAKC,SAASC,yBACpB,IAAK,MAAMC,KAAKP,MAAMC,KAAKF,EAAES,YAC5BJ,EAAGK,YAAYF,GAEhBR,EAAEW,WAAWC,aAAaP,EAAIL,IAmBjC,SAAS6G,EAAe/G,EAAKC,GAC5B,IAAK,MAAMS,KAAKP,MAAMC,KAAKJ,EAAIW,YACX,IAAfD,EAAEO,SACAzC,EAASkC,EAAGT,EAAKiB,gBAAgB6F,EAAerG,EAAGT,GAC/B,IAAfS,EAAEO,UACZyI,EAAgBhJ,EAAGT,GAKtB,SAASyJ,EAAgBtI,EAAInB,GAC5B,IAAIR,EAAM2B,EAAGa,YACbxC,EAAMD,EAAiCC,GAEvC,MAAOuF,EAAI2C,GAAMgC,EAAWlK,GACtBmD,EAAIC,EAAepD,EAAKuF,EAAI2C,EAAI1H,GACtCmB,EAAGP,WAAWC,aAAa8B,EAAGxB,GAO/B,MAAMwI,EAAK,0lCAA0lClD,MAAM,KACrmCmD,EAAK,0MAA0MnD,MAAM,KAErNoD,EAAY,4BAA4BpD,MAAM,KAC9CG,EAAY,MAAMH,MAAM,KACxBqD,EAAY,MAAMrD,MAAM,KAE9B,SAASiD,EAAWlK,GACnB,MAAMuF,EAmCP,SAA6BvF,GAC5B,MAAMuF,EAAK,GACX,IAAK,MAAMtE,KAAKjB,EACfuF,EAAGhB,KAAK0D,EAAYhH,IAErB,OAAOsE,EAxCIgF,CAAoBvK,GACzBkI,EAAKxH,MAAM6E,EAAGlD,QAAQmI,KAAK,IAgElC,SAA2BjF,EAAI2C,GAC9B,IAAK,IAAIhE,EAAI,EAAGA,EAAIqB,EAAGlD,OAAQ6B,GAAK,EAAG,CACtC,MAAMuG,EAAKlF,EAAGrB,EAAI,GACZwG,EAAKnF,EAAGrB,GACdgE,EAAGhE,KAAOqC,EAAMkE,EAAKC,IAAO,IAAMnE,EAAM,IAAMmE,IAAO,IAAMnE,EAAMkE,EAAK,MAAQ,IAlE/EE,CAAkBpF,EAAI2C,GAEtB,MAAM0C,EAAOlK,MAAMC,KAAKX,GAQxB,OAgED,SAAyB4K,EAAM1C,EAAI2C,GAClC,IAAK,MAAMC,KAAMD,EAAS,CACzB,MAAME,EAAMrK,MAAMC,KAAKmK,GACjBE,EAAMD,EAAI1I,OAEhB,IAAK,IAAI4I,EAAM,IAAK,CACnB,MAAMC,EAAOC,EAAaP,EAAMG,EAAKE,GACrC,IAAc,IAAVC,EAAa,MACjB,MAAME,EAAOF,EAAOF,EAEpB9C,EAAGgD,IAASF,EACZ,IAAK,IAAI9G,EAAI,EAAGA,EAAI8G,EAAK9G,GAAK,EAAGgE,EAAGgD,EAAOhH,IAAM8G,EACjDC,EAAMG,IAnFRC,CAAgBT,EAAM1C,EAAIiC,GAyG3B,SAAyBS,EAAM1C,EAAI2C,GAClC,IAAK,MAAMC,KAAMD,EAAS,CACzB,MAAME,EAAMrK,MAAMC,KAAKmK,GACjBE,EAAMD,EAAI1I,OAEhB,IAAK,IAAI4I,EAAM,IAAM,CACpB,MAAMC,EAAOC,EAAaP,EAAMG,EAAKE,GACrC,IAAc,IAAVC,EAAa,MACjB,MAAME,EAAOF,EAAOF,EAEpB9C,EAAGgD,IAASF,EACZ,IAAK,IAAI9G,EAAI,EAAGA,EAAI8G,EAAK9G,GAAK,EAAGgE,EAAGgD,EAAOhH,IAAM8G,EACjDC,EAAMG,IApHRE,CAAgBV,EAAM1C,EAAIkC,GAuF3B,SAAiCQ,EAAM1C,EAAI2C,EAASU,GACnD,IAAK,MAAMT,KAAMD,EAAS,CACzB,MAAME,EAAMrK,MAAMC,KAAKmK,GACjBE,EAAMD,EAAI1I,OAEhB,IAAK,IAAI4I,EAAM,IAAK,CACnB,MAAMC,EAAOC,EAAaP,EAAMG,EAAKE,GACrC,IAAc,IAAVC,EAAa,MACjB,MAAME,EAAOF,EAAOF,EAEpB9C,EAAGgD,EAAOK,IAAOP,EAAMO,EACvB,IAAK,IAAIrH,EAAI,EAAGA,EAAI8G,EAAMO,EAAIrH,GAAK,EAAGgE,EAAGgD,EAAOK,EAAKrH,IAAM8G,EAAMO,EACjEN,EAAMG,IAjGRI,CAAwBZ,EAAM1C,EAAImC,EAAK,GACvCoB,EAAgBb,EAAMrF,EAAI2C,EAAId,EAAWsE,EAAc,KAAM,EAAG,GAChED,EAAgBb,EAAMrF,EAAI2C,EAAIoC,EAAWqB,EAAc,IAAM,EAAG,GAEzD,CAACpG,EAAI2C,GAOb,MAAMyD,EAAe,WACfD,EAAe,YAGfE,EAAgB,CACrB,CAAC,IAAK,qBACN,CAAC,IAAK,qBACN,CAAC,IAAK,gBACN,CAAC,IAAK,WACN,CAAC,IAAK,gBACN,CAAC,IAAK,iDACN,CAAC,IAAK,aACN,CAAC,IAAK,QAWP,SAAS3D,EAAYhH,GACpB,IAAK,MAAO0E,EAAG7D,KAAM8J,EACpB,GAAI9J,EAAE4H,KAAKzI,GAAI,OAAO0E,EAEvB,MAAO,IAOR,MAAMY,EAAQ,CACb,MAAO,EAAG,KAAM,EAChB,KAAM,EACN,KAAM,GAAI,MAAO,GACjB,MAAO,EAAG,MAAO,EACjBC,GAAM,EAAGC,GAAM,EAAGC,GAAM,EAAIE,GAAM,EAAGC,GAAM,EAAGgF,GAAM,EACpDlF,GAAM,EACNmF,GAAM,EAAGC,GAAM,EAAGC,GAAM,EACxBlF,GAAM,EAAGC,GAAM,GAkEhB,SAAS0E,EAAgBb,EAAMrF,EAAI2C,EAAI2C,EAASoB,EAASC,EAASC,EAAOC,GACxE,MAAMC,EAAM9G,EAAGlD,OAEf,IAAK,MAAMyI,KAAMD,EAAS,CACzB,MAAME,EAAMrK,MAAMC,KAAKmK,GACjBE,EAAMD,EAAI1I,OAEhB,IAAK,IAAI4I,EAAM,IAAM,CACpB,MAAMC,EAAOC,EAAaP,EAAMG,EAAKE,GACrC,IAAc,IAAVC,EAAa,MACjB,MAAME,EAAOF,EAAOF,EAEpB,IACW,IAATE,GAA0B,IAATA,GAAce,EAAQ9J,SAASoD,EAAG2F,EAAO,OAC1DE,IAASiB,GAAQjB,EAAOiB,GAAOH,EAAQ/J,SAASoD,EAAG6F,KACnD,CACDlD,EAAGgD,IAASiB,EACRf,EAAOlD,EAAG7F,SAAQ6F,EAAGkD,IAASgB,GAClC,IAAK,IAAIlI,EAAI,EAAGA,EAAI8G,EAAK9G,GAAK,EAAGgE,EAAGgD,EAAOhH,IAAM8G,EAElDC,EAAMG,IAKT,SAASD,EAAamB,EAAOC,EAAeC,EAAY,GACvD,GAAIF,MAAAA,EACH,OAAQ,EAET,GAAqB,IAAjBA,EAAMjK,OACT,OAAO,EAER,IAAK,IAAI6B,EAAIsI,EAAWtI,EAAIoI,EAAMjK,OAASkK,EAAclK,OAAS,EAAG6B,GAAK,EAAG,CAC5E,IAAIhE,GAAQ,EAEZ,IAAK,IAAIuM,EAAI,EAAGA,EAAIF,EAAclK,OAAQoK,GAAK,EAC9C,GAAIH,EAAMpI,EAAIuI,KAAOF,EAAcE,GAAI,CACtCvM,GAAQ,EACR,MAGF,GAAIA,EACH,OAAOgE,EAGT,OAAQ,EAOT,SAASd,EAAepD,EAAKuF,EAAI2C,EAAI1H,GACpC,MAAMM,EAAKC,SAASC,yBACpB,IAAI0L,EAAO,GACPzB,EAAO,EAEP0B,EAAM,EACV,IAAK,MAAM1L,KAAKjB,EAAK,CACpB,GAAIkI,EAAGyE,IAAQ,EAAG,CAEjBC,EAAa9L,EAAI4L,EADFG,EAAqBtH,EAAI0F,EAAK0B,GACdnM,EAAKuJ,cACpC2C,EAAO,GACPzB,EAAO0B,EAERD,GAAQzL,EACR0L,GAAQ,EAET,GAAID,EAAKrK,OAAQ,CAEhBuK,EAAa9L,EAAI4L,EADFG,EAAqBtH,EAAI0F,EAAK1F,EAAGlD,QACjB7B,EAAKuJ,cAErC,OAAOjJ,EAGR,SAAS8L,EAAa9L,EAAId,EAAK8M,EAAQhI,GACtC,GAAIgI,EACHhM,EAAGK,YAAYJ,SAAS4D,eAAe3E,QACjC,CACN,MAAM+M,EAAIhM,SAAS8D,cAAc,QACjCkI,EAAE5L,YAAYJ,SAAS4D,eAAe3E,IAClC8E,EAAMzC,QAAQ5C,EAASsN,EAAGjI,GAC9BhE,EAAGK,YAAY4L,IAIjB,SAASF,EAAqBtH,EAAI0F,EAAK+B,GACtC,IAAK,IAAI9I,EAAI+G,EAAK/G,EAAI8I,EAAK9I,GAAK,EAAG,CAClC,MAAMyB,EAAIJ,EAAGrB,GACb,IAnMmB,MAmML/B,SAASwD,GACtB,OAAO,EAGT,OAAO,EAGR7G,EAAGmO,YA/SH,SAAoB1H,EAAI/E,EAAO,IAC9B,GAAkB,IAAd+E,EAAGlD,OAAP,CAEA7B,EAAOgF,OAAOC,OAAO,CACpBsE,aAAsB,GACtBtI,cAAsB,oBACtBiE,sBAAsB,GACpBlF,GAEH,IAAK,MAAMmF,KAAKJ,EAEf,GADA+B,EAAe3B,EAAGnF,GACdA,EAAKkF,qBAAsB,CAC9B,MAAMvC,EAAI,WACT0G,EAAclE,EAAGnF,GACjBmF,EAAEC,oBAAoB,cAAezC,IAEtCwC,EAAEE,iBAAiB,cAAe1C,MAgSrCrE,EAAGoO,iBA9QH,SAAelN,EAAKQ,EAAO,IAC1BA,EAAOgF,OAAOC,OAAO,CACpBsE,aAAe,GACftI,cAAe,qBACbjB,GAEH,MAAO+E,EAAI2C,GAAMgC,EAAWlK,GAC5B,OAAOoD,EAAepD,EAAKuF,EAAI2C,EAAI1H,IApDrC,GAhcD,CA6zBG3B,OAAM","file":"ja.min.js","sourcesContent":["/**\n *\n * Style for Japanese Text (JS)\n *\n * @author Takuto Yanagida\n * @version 2021-11-03\n *\n */\n\n\nwindow['NACSS'] = window['NACSS'] || {};\n\n\n(function (NS) {\n\n\t(function () {\n\t\t/**\n\t\t *\n\t\t * Kerning\n\t\t *\n\t\t * @author Takuto Yanagida\n\t\t * @version 2021-11-03\n\t\t *\n\t\t */\n\t\t\n\t\t\n\t\tfunction initialize(ts, opts = {}) {\n\t\t\tif (ts.length === 0) return;\n\t\t\n\t\t\topts = Object.assign({\n\t\t\t\tstyleKerning        : ':ncKern',\n\t\t\t\tstyleDisabled       : ':ncNoKerning',\n\t\t\t\tdoAssignAttribute   : true,\n\t\t\t\tdoDisableOnSelecting: true,\n\t\t\t}, opts);\n\t\t\n\t\t\tfor (const t of ts) {\n\t\t\t\tkernElement(t, dict, opts);\n\t\t\t\tif (opts.doAssignAttribute && opts.doDisableOnSelecting) {\n\t\t\t\t\tconst f = function () {\n\t\t\t\t\t\tremoveKerning(t, opts);\n\t\t\t\t\t\tt.removeEventListener('selectstart', f);\n\t\t\t\t\t}\n\t\t\t\t\tt.addEventListener('selectstart', f);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction removeKerning(elm, opts) {\n\t\t\tfor (const s of Array.from(elm.getElementsByTagName('span'))) {\n\t\t\t\tif (hasClass(s, opts.styleKerning)) {\n\t\t\t\t\tconst df = document.createDocumentFragment();\n\t\t\t\t\tfor (const c of Array.from(s.childNodes)) {\n\t\t\t\t\t\tdf.appendChild(c);\n\t\t\t\t\t}\n\t\t\t\t\ts.parentNode.replaceChild(df, s);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction apply(str, opts = {}) {\n\t\t\topts = Object.assign({\n\t\t\t\tstyleKerning     : ':ncKern',\n\t\t\t\tstyleDisabled    : ':ncNoKerning',\n\t\t\t\tdoAssignAttribute: true,\n\t\t\t}, opts);\n\t\t\n\t\t\tconst ks = getKerning(str, dict, false, opts.doAssignAttribute);\n\t\t\tif (ks.length) {\n\t\t\t\treturn createFragment(str, ks, opts);\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t\t\n\t\t\n\t\t// -----------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction kernElement(elm, dict, opts) {\n\t\t\tfor (const c of Array.from(elm.childNodes)) {\n\t\t\t\tif (c.nodeType === 1) {  // ELEMENT_NODE\n\t\t\t\t\tif (!hasClass(c, opts.styleDisabled)) kernElement(c, dict, opts);\n\t\t\t\t} else if (c.nodeType === 3) {  // TEXT_NODE\n\t\t\t\t\tkernTextNode(c, dict, opts);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction kernTextNode(tn, dict, opts) {\n\t\t\tconst [isHead, isTail] = isEnd(tn);\n\t\t\n\t\t\tlet str = tn.textContent;\n\t\t\tif (isHead) str = removeHeadWhiteSpaces(str);\n\t\t\tif (isTail) str = removeTailWhiteSpaces(str);\n\t\t\tstr = removeWhiteSpacesBetweenZenChars(str);\n\t\t\n\t\t\tlet nt = '';\n\t\t\tif (tn.nextSibling && tn.nextSibling.nodeType === 1 && getComputedStyle(tn.nextSibling).display === 'inline') {\n\t\t\t\tnt = tn.nextSibling.innerText;\n\t\t\t}\n\t\t\tif (!tn.nextSibling && tn.parentNode.nextSibling) {\n\t\t\t\tconst parentNext = tn.parentNode.nextSibling;\n\t\t\t\tif (parentNext.nodeType === 1) {  // ELEMENT_NODE\n\t\t\t\t\tconst pnd = getComputedStyle(parentNext).display;\n\t\t\t\t\tif (pnd.includes('inline')) {\n\t\t\t\t\t\tnt = parentNext.innerText;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (parentNext.nodeType === 3) {  // TEXT_NODE\n\t\t\t\t\tnt = parentNext.textContent;\n\t\t\t\t}\n\t\t\t}\n\t\t\n\t\t\tconst ks = getKerning(str, dict, isHead, nt, opts.doAssignAttribute);\n\t\t\tif (ks.length) {\n\t\t\t\tconst f = createFragment(str, ks, opts);\n\t\t\t\ttn.parentNode.replaceChild(f, tn);\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction isEnd(tn) {\n\t\t\tconst p = tn.parentNode;\n\t\t\tif (!(p instanceof HTMLElement)) return [false, false];\n\t\t\tconst pd = getComputedStyle(p).display;\n\t\t\tif (!pd.includes('inline')) {  // Block\n\t\t\t\treturn isSiblingBlock(tn);\n\t\t\t}\n\t\t\tif (pd === 'inline-block') {  // Inline block\n\t\t\t\tif (p.childNodes.length !== 1) {  // The parent has multiple nodes.\n\t\t\t\t\treturn isSiblingBlock(tn);\n\t\t\t\t}\n\t\t\t\tconst pp = p.parentNode;\n\t\t\t\tif (pp) {\n\t\t\t\t\tconst ppd = getComputedStyle(pp).display;\n\t\t\t\t\tif (!ppd.includes('inline')) {\n\t\t\t\t\t\treturn isSiblingBlock(p, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn [false, false];  // Not inline block\n\t\t}\n\t\t\n\t\tfunction isSiblingBlock(n, greedy = false) {\n\t\t\treturn [greedy ? isPreviousBlockGreedy(n.previousSibling) : isBlock(n.previousSibling), isBlock(n.nextSibling)];\n\t\t}\n\t\t\n\t\tfunction isBlock(n) {\n\t\t\tif (n === null) return true;\n\t\t\tif (!(n instanceof HTMLElement)) return false;\n\t\t\tif (n.tagName === 'BR') return true;\n\t\t\treturn !getComputedStyle(n).display.includes('inline');\n\t\t}\n\t\t\n\t\tfunction isPreviousBlockGreedy(n) {\n\t\t\twhile (true) {\n\t\t\t\tif (n === null) return true;\n\t\t\t\tif (n.nodeType === 1) {\n\t\t\t\t\tif (n.tagName === 'BR') return true;\n\t\t\t\t\treturn !getComputedStyle(n).display.includes('inline');\n\t\t\t\t}\n\t\t\t\tif (n.nodeType === 3) {\n\t\t\t\t\tif (!n.textContent.trim()) return true;\n\t\t\t\t}\n\t\t\t\tn = n.previousSibling;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\t// -----------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction getKerning(str, dict, isHead, nextNodeText, assignAttr) {\n\t\t\tlet strArray = Array.from(str);\n\t\t\tconst ret = [];\n\t\t\n\t\t\tif (nextNodeText.length) {\n\t\t\t\tstrArray = strArray.concat(Array.from(nextNodeText));\n\t\t\t}\n\t\t\tlet l = 0;\n\t\t\n\t\t\tfor (let i = 0; i < strArray.length; i += 1) {\n\t\t\t\tconst c0 = strArray[i];\n\t\t\t\tconst c1 = strArray[i + 1];\n\t\t\n\t\t\t\tlet a = '';\n\t\t\t\tif (c0 !== '' && c1 !== '' && dict.has(c0 + c1)) {\n\t\t\t\t\ta = assignAttr ? 's' : 'letter-spacing:-0.4em;';\n\t\t\t\t}\n\t\t\t\tif (i === 0 && isHead && c0 !== '' && dict.has(c0)) {\n\t\t\t\t\ta += assignAttr ? 'h' : 'margin-left:-0.4em';\n\t\t\t\t}\n\t\t\t\tif (a.length) {\n\t\t\t\t\tif (l) {\n\t\t\t\t\t\tret.push(l);\n\t\t\t\t\t\tl = 0;\n\t\t\t\t\t}\n\t\t\t\t\tret.push(a);\n\t\t\t\t} else {\n\t\t\t\t\tl += 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (ret.length && l) ret.push(l);\n\t\t\treturn ret;\n\t\t}\n\t\t\n\t\tfunction createFragment(str, ks, opts) {\n\t\t\tconst strArray = Array.from(str);\n\t\t\tconst f = document.createDocumentFragment();\n\t\t\tlet i = 0;\n\t\t\tfor (const k of ks) {\n\t\t\t\tif (Number.isInteger(k)) {\n\t\t\t\t\tconst n = document.createTextNode(strArray.slice(i, i + k).join(''));\n\t\t\t\t\tf.appendChild(n);\n\t\t\t\t\ti += k;\n\t\t\t\t} else {\n\t\t\t\t\tconst n = document.createElement('span');\n\t\t\t\t\tn.appendChild(document.createTextNode(strArray.slice(i, i + 1).join('')));\n\t\t\t\t\tif (k.length <= 2) {\n\t\t\t\t\t\tsetClass(n, opts.styleKerning, true, k);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tn.style = k;\n\t\t\t\t\t}\n\t\t\t\t\tf.appendChild(n);\n\t\t\t\t\ti += 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn f;\n\t\t}\n\t\t\n\t\t\n\t\t// -----------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tconst dict = new Set();\n\t\t{\n\t\t\taddPairs(dict, '、，。．・｜：　', '「『（［｛〈《【〔');\n\t\t\taddPairs(dict, '」』）］｝〉》】〕', '、，。．・｜：,.');\n\t\t\taddPairs(dict, '」』）］｝〉》】〕', '「『（［｛〈《【〔');\n\t\t\taddPairs(dict, '「『（［｛〈《【〔', '「『（［｛〈《【〔');\n\t\t\taddPairs(dict, '」』）］｝〉》】〕', '」』）］｝〉》】〕');\n\t\t\taddSolos(dict, '「『（［｛〈《【〔');\n\t\t\n\t\t\tfunction addPairs(dict, cs0, cs1) {\n\t\t\t\tfor (const c0 of cs0) {\n\t\t\t\t\tfor (const c1 of cs1) {\n\t\t\t\t\t\tdict.add(c0 + c1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\n\t\t\tfunction addSolos(dict, head) {\n\t\t\t\tfor (const h of head) {\n\t\t\t\t\tdict.add(h);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tNS.jaKerning      = initialize;\n\t\tNS.jaApplyKerning = apply;\n\t})();\n\n\t(function () {\n\t\t/**\n\t\t *\n\t\t * Segmenter\n\t\t *\n\t\t * @author Takuto Yanagida\n\t\t * @version 2021-11-02\n\t\t *\n\t\t */\n\t\t\n\t\t\n\t\tconst CHAR_TYPES = ['S', 'E', 'I', 'K', 'H', 'N'];\n\t\tconst CHAR_PATS = {\n\t\t\tS: /[「『（［｛〈《【〔〖〘〚＜“]/u,\n\t\t\tE: /[」』）］｝〉》】〕〗〙〛＞”、，。．？！を：・]/u,\n\t\t\tI: /[ぁ-んゝ]/u,\n\t\t\tK: /[ァ-ヴーｱ-ﾝﾞｰ]/u,\n\t\t\tH: /[一-龠々〆ヵヶ]/u,\n\t\t\tN: /[0-9０-９]/u\n\t\t};\n\t\tconst PAIRS = { 'S*': 1, 'II': 1, 'KK': 1, 'HH': 1, 'HI': 1, 'NN': 1, 'OO': 1, 'ON': 1, 'NO': 1 };\n\t\tconst PARTICLE_A = 'でなければ|について|により|かしら|くらい|けれど|なのか|ばかり|ながら|ことよ|こそ|こと|さえ|しか|した|たり|だけ|だに|だの|つつ|ても|てよ|でも|とも|から|など|なり|ので|のに|ほど|まで|もの|やら|より|って|で|と|な|に|ね|の|も|は|ば|へ|や|わ|を|か|が|さ|し|ぞ|て'.split('|');\n\t\tconst PARTICLE_H = {};\n\t\tfor (const ja of PARTICLE_A) PARTICLE_H[ja] = true;\n\t\tconst PRE_KANJI = 'お|ご'.split('|');\n\t\tconst ADNOMINAL = 'ありとあらゆる|おもいきった|たくまざる|ああいう|ああした|あらゆる|いかなる|いかれる|いわゆる|おおきな|おかしな|そういう|ちいさな|なだたる|はずべき|ひょんな|ふとした|あんな|かかる|きたる|こんな|そんな|とんだ|どんな|むこう|あの|ある|かの|この|さる|その|どの|わが'.split('|');\n\t\t\n\t\tfunction initialize(ts) {\n\t\t\tfor (const t of ts) segmentElement(t);\n\t\t}\n\t\t\n\t\t\n\t\t// -------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction segmentElement(elm) {\n\t\t\tconst tn = elm.tagName;\n\t\t\tconst fs = [];\n\t\t\n\t\t\tfor (const c of Array.from(elm.childNodes)) {\n\t\t\t\tif (c.nodeType === 1) {  // ELEMENT_NODE\n\t\t\t\t\tsegmentElement(c);\n\t\t\t\t\tfs.push(c.outerHTML);\n\t\t\t\t} else if (c.nodeType === 3) {  // TEXT_NODE\n\t\t\t\t\tfs.push(apply(c.textContent, tn));\n\t\t\t\t}\n\t\t\t}\n\t\t\telm.innerHTML = fs.join('');\n\t\t}\n\t\t\n\t\tfunction apply(text, tn) {\n\t\t\tlet parts = [];\n\t\t\tlet tP = '';\n\t\t\tlet word = '';\n\t\t\tlet tWordHead = '';\n\t\t\n\t\t\tfor (let i = 0, I = text.length; i < I; i += 1) {\n\t\t\t\tconst c = text.substring(i, i + 1);\n\t\t\t\tconst t = getCharType(c);\n\t\t\t\tif (PAIRS[tP + t] || PAIRS['*' + t] || PAIRS[tP + '*']) {\n\t\t\t\t\tword += c;\n\t\t\t\t\tif (word === c) tWordHead = t;\n\t\t\t\t} else {\n\t\t\t\t\tif (0 < word.length) parts.push([word, tWordHead, tP]);\n\t\t\t\t\tword = c;\n\t\t\t\t\ttWordHead = t;\n\t\t\t\t}\n\t\t\t\ttP = t;\n\t\t\t}\n\t\t\tif (0 < word.length) parts.push([word, tWordHead, tP]);\n\t\t\n\t\t\tparts = concatParticle(parts);\n\t\t\tparts = concatStopChar(parts);\n\t\t\tparts = concatMeasureWord(parts);\n\t\t\tparts = splitKanjiPrefix(parts, PRE_KANJI);\n\t\t\tparts = splitTailAdnominal(parts, ADNOMINAL);\n\t\t\tif (parts.length === 1 && (!tn || tn === 'SPAN')) return text;\n\t\t\treturn wrapWithSpan(parts);\n\t\t}\n\t\t\n\t\tfunction concatParticle(ws) {\n\t\t\tconst newWs = [];\n\t\t\tlet wP = null;\n\t\t\n\t\t\tfor (const w of ws) {\n\t\t\t\tif (wP && PARTICLE_H[w[0]]) {\n\t\t\t\t\twP[0] += w[0];\n\t\t\t\t\twP[2] = w[2];\n\t\t\t\t} else {\n\t\t\t\t\tnewWs.push(w);\n\t\t\t\t\twP = w;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn newWs;\n\t\t}\n\t\t\n\t\tfunction concatStopChar(ws) {\n\t\t\tconst newWs = [];\n\t\t\tlet wP = null;\n\t\t\n\t\t\tfor (const w of ws) {\n\t\t\t\tif (wP && w[1] === 'E') {\n\t\t\t\t\twP[0] += w[0];\n\t\t\t\t\twP[2] = w[2];\n\t\t\t\t} else {\n\t\t\t\t\tnewWs.push(w);\n\t\t\t\t\twP = w;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn newWs;\n\t\t}\n\t\t\n\t\tfunction concatMeasureWord(ws) {\n\t\t\tconst newWs = [];\n\t\t\tlet wP = null;\n\t\t\n\t\t\tfor (const w of ws) {\n\t\t\t\tif (wP && wP[2] === 'N') {\n\t\t\t\t\twP[0] += w[0];\n\t\t\t\t\twP[2] = w[2];\n\t\t\t\t} else {\n\t\t\t\t\tnewWs.push(w);\n\t\t\t\t\twP = w;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn newWs;\n\t\t}\n\t\t\n\t\tfunction splitKanjiPrefix(ws, pres) {\n\t\t\tif (ws.length <= 1) return ws;\n\t\t\n\t\t\tfor (let i = 1, I = ws.length; i < I; i += 1) {\n\t\t\t\tconst w = ws[i], wP = ws[i - 1], swP = wP[0];\n\t\t\t\tif (w[1] !== 'H') continue;\n\t\t\n\t\t\t\tfor (const pre of pres) {\n\t\t\t\t\tif (swP.endsWith(pre)) {\n\t\t\t\t\t\tconst len = pre.length;\n\t\t\t\t\t\twP[0] = swP.substr(0, swP.length - len);\n\t\t\t\t\t\twP[2] = getCharType(wP[0][wP[0].length - 1]);\n\t\t\t\t\t\tw[0] = pre + w[0];\n\t\t\t\t\t\tw[1] = 'I';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn ws;\n\t\t}\n\t\t\n\t\tfunction splitTailAdnominal(ws, pns) {\n\t\t\tconst newWs = [];\n\t\t\n\t\t\tfor (const w of ws) {\n\t\t\t\tlet split = false;\n\t\t\t\tfor (const pn of pns) {\n\t\t\t\t\tif (w[0].endsWith(pn)) {\n\t\t\t\t\t\tw[0] = w[0].substr(0, w[0].length - pn.length);\n\t\t\t\t\t\tnewWs.push(w);\n\t\t\t\t\t\tnewWs.push([pn, 'I', 'I']);\n\t\t\t\t\t\tsplit = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (split) continue;\n\t\t\t\tnewWs.push(w);\n\t\t\t}\n\t\t\treturn newWs;\n\t\t}\n\t\t\n\t\tfunction wrapWithSpan(ws) {\n\t\t\tconst reB = /^\\s/;\n\t\t\tconst reA = /\\s$/;\n\t\t\tlet ret = '';\n\t\t\n\t\t\tfor (const w of ws) {\n\t\t\t\tif (w[1] !== 'O' || w[2] !== 'O') {\n\t\t\t\t\tconst sb = reB.exec(w[0]);\n\t\t\t\t\tconst sa = reA.exec(w[0]);\n\t\t\t\t\tconst before = (sb !== null) ? sb[0] : '';\n\t\t\t\t\tconst after  = (sa !== null) ? sa[0] : '';\n\t\t\n\t\t\t\t\tret += before + '<span>' + w[0] + '</span>' + after;\n\t\t\t\t} else {\n\t\t\t\t\tret += w[0];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn ret;\n\t\t}\n\t\t\n\t\tfunction getCharType(c) {\n\t\t\tfor (const t of CHAR_TYPES) {\n\t\t\t\tconst p = CHAR_PATS[t];\n\t\t\t\tif (p.test(c)) return t;\n\t\t\t}\n\t\t\treturn 'O';\n\t\t}\n\t\t\n\t\tNS.jaSegmenterOld      = initialize;\n\t\tNS.jaApplySegmenterOld = apply;\n\t})();\n\n\t(function () {\n\t\t/**\n\t\t *\n\t\t * Segmenter\n\t\t *\n\t\t * @author Takuto Yanagida\n\t\t * @version 2021-11-04\n\t\t *\n\t\t */\n\t\t\n\t\t\n\t\tfunction initialize(ts, opts = {}) {\n\t\t\tif (ts.length === 0) return;\n\t\t\n\t\t\topts = Object.assign({\n\t\t\t\tstyleSegment        : '',\n\t\t\t\tstyleDisabled       : ':ncNoSegmentation',\n\t\t\t\tdoDisableOnSelecting: true,\n\t\t\t}, opts);\n\t\t\n\t\t\tfor (const t of ts) {\n\t\t\t\tsegmentElement(t, opts);\n\t\t\t\tif (opts.doDisableOnSelecting) {\n\t\t\t\t\tconst f = function () {\n\t\t\t\t\t\tremoveSegment(t, opts);\n\t\t\t\t\t\tt.removeEventListener('selectstart', f);\n\t\t\t\t\t}\n\t\t\t\t\tt.addEventListener('selectstart', f);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction removeSegment(elm, opts) {\n\t\t\tconst sty = opts.styleSegment;\n\t\t\tfor (const s of Array.from(elm.getElementsByTagName('span'))) {\n\t\t\t\tif ((sty.length === 0 && s.className === '') || hasClass(s, sty)) {\n\t\t\t\t\tconst df = document.createDocumentFragment();\n\t\t\t\t\tfor (const c of Array.from(s.childNodes)) {\n\t\t\t\t\t\tdf.appendChild(c);\n\t\t\t\t\t}\n\t\t\t\t\ts.parentNode.replaceChild(df, s);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction apply(str, opts = {}) {\n\t\t\topts = Object.assign({\n\t\t\t\tstyleSegment : '',\n\t\t\t\tstyleDisabled: ':ncNoSegmentation',\n\t\t\t}, opts);\n\t\t\n\t\t\tconst [ts, ws] = getSegment(str);\n\t\t\treturn createFragment(str, ts, ws, opts);\n\t\t}\n\t\t\n\t\t\n\t\t// -------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction segmentElement(elm, opts) {\n\t\t\tfor (const c of Array.from(elm.childNodes)) {\n\t\t\t\tif (c.nodeType === 1) {  // ELEMENT_NODE\n\t\t\t\t\tif (!hasClass(c, opts.styleDisabled)) segmentElement(c, opts);\n\t\t\t\t} else if (c.nodeType === 3) {  // TEXT_NODE\n\t\t\t\t\tsegmentTextNode(c, opts);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction segmentTextNode(tn, opts) {\n\t\t\tlet str = tn.textContent;\n\t\t\tstr = removeWhiteSpacesBetweenZenChars(str);\n\t\t\n\t\t\tconst [ts, ws] = getSegment(str);\n\t\t\tconst f = createFragment(str, ts, ws, opts);\n\t\t\ttn.parentNode.replaceChild(f, tn);\n\t\t}\n\t\t\n\t\t\n\t\t// -----------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tconst IW = 'そうはいうものの,そればかりでなく,ありとあらゆる,いずれにしても,かけがえのない,そうしてみると,そうすることで,そうでないなら,そうではあるが,それにくわえて,それはさておき,どっちにしても,とはいうものの,なぜかというと,にもかかわらず,いいかえると,いずれにしろ,いずれにせよ,いってみれば,おもいきった,しかしながら,じつのところ,じつはいうと,そうしないと,そうではなく,そのためには,それどころか,それにしても,それによって,そればかりか,それはそうと,どちらにせよ,どっちにせよ,いろいろな,このように,さまざまな,さもないと,したがって,そういえば,そうしたら,そうすると,そうすれば,そうなると,そうなれば,そのかわり,それなのに,それゆえに,たくまざる,だとしたら,だとすると,だとすれば,ではあるが,というのは,というのも,というより,なぜならば,やすやすと,ようするに,ああいう,ああした,あたかも,あらゆる,あるいは,いかなる,いつかは,いっぱい,いろんな,いわゆる,おおきな,おかしな,おそらく,おなじく,おまけに,かえって,かくして,かわりに,くわえて,ぐんぐん,けれども,こういう,こうして,このため,しかるに,しばらく,すなわち,そういう,そうした,そのうえ,そのくせ,そのため,そもそも,それから,それから,それでは,それでも,それとも,それなら,それには,たいした,たいそう,たくさん,だけども,たとえば,たやすく,ちいさな,ちなみに,というか,どういう,とうてい,ときどき,ところが,どころか,ところで,となると,となれば,とにかく,とはいえ,ともあれ,とりわけ,ないしは,なかでも,なぜなら,なぜなら,なだたる,なにしろ,ならびに,はじめに,はずべき,はなはだ,ひいては,ひょんな,ふとした,ほかには,ほかにも,めっきり,もしくは,もっとも,あまり,あらぬ,ありし,あんな,いただ,いつか,いつも,いわば,および,かかる,かなり,きたる,きっと,けれど,ことに,こんな,さらに,しかし,しかも,じつは,じゃあ,すぐに,すぐに,すると,そこで,そして,そっと,それで,それに,そんな,だから,だけど,ただし,だって,たまに,つぎに,つまり,ですが,とある,どうか,ときに,とくに,とても,とんだ,どんな,なにせ,なのに,ならば,ほんの,まさか,または,むこう,むしろ,もっと,もっと,もっと,ものの,やはり,ゆえに,ようは,よって,ああ,あの,ある,かつ,かの,けど,こう,この,さて,さる,そう,その,だが,ただ,では,でも,どう,どの,なお,なぜ,のに,また,もし,よく,わが'.split(',');\n\t\tconst AW = 'けれども,ところで,において,について,かしら,がてら,くらい,ぐらい,けれど,ってば,ながら,などの,なんぞ,ばかり,ものか,ものの,かい,から,かり,きり,こそ,さえ,しか,ずつ,だけ,だの,たり,つつ,では,ても,でも,とも,なぞ,など,なり,にて,には,ので,のに,のみ,ほど,まで,まま,もん,やら,より,か,が,さ,し,ぜ,ぞ,て,で,と,な,に,ね,の,は,ば,へ,も,や,よ,わ,を'.split(',');\n\t\t\n\t\tconst AI1       = 'がおこな,のような,があり,がおき,ができ,がでて'.split(',');\n\t\tconst PRE_KANJI = 'お,ご'.split(',');\n\t\tconst PRE_NUM   = '第,約'.split(',');\n\t\t\n\t\tfunction getSegment(str) {\n\t\t\tconst ts = createCharTypeArray(str);\n\t\t\tconst ws = Array(ts.length).fill(0);\n\t\t\n\t\t\tweightByCharTypes(ts, ws);\n\t\t\n\t\t\tconst strA = Array.from(str);\n\t\t\tdivideByPhrases(strA, ws, IW);\n\t\t\tconcatByPhrases(strA, ws, AW);\n\t\t\n\t\t\tdivideByCombinedPhrases(strA, ws, AI1, 1);\n\t\t\tweightByPhrases(strA, ts, ws, PRE_KANJI, CLS_ALL,      'H', -1, 2);\n\t\t\tweightByPhrases(strA, ts, ws, PRE_NUM,   CLS_WO_KANJI, 'N',  0, 2);\n\t\t\n\t\t\treturn [ts, ws];\n\t\t}\n\t\t\n\t\t\n\t\t// -----------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tconst CLS_WO_KANJI = 'SETIKNVO';\n\t\tconst CLS_ALL      = 'SETIKHNVO';\n\t\tconst CLS_ORIG     = 'NVO';\n\t\t\n\t\tconst CHAR_PATTERNS = [\n\t\t\t['S', /[「『（［｛〈《【〔〖〘〚＜“]/u],\n\t\t\t['E', /[」』）］｝〉》】〕〗〙〛＞”]/u],\n\t\t\t['T', /[、，。．？！を：・]/u],\n\t\t\t['I', /[ぁ-んゝ]/u],\n\t\t\t['K', /[ァ-ヴーｱ-ﾝﾞｰ]/u],\n\t\t\t['H', /[々〆ヵヶ]|[\\u4E00-\\u9FFF]|[\\u{20000}-\\u{2A6DF}]/u],  // Special Characters, CJK Unified Ideographs, CJK Unified Ideographs Extension B\n\t\t\t['N', /[0-9０-９]/u],\n\t\t\t['V', /\\s/u],\n\t\t];\n\t\t\n\t\tfunction createCharTypeArray(str) {\n\t\t\tconst ts = [];\n\t\t\tfor (const c of str) {\n\t\t\t\tts.push(getCharType(c));\n\t\t\t}\n\t\t\treturn ts;\n\t\t}\n\t\t\n\t\tfunction getCharType(c) {\n\t\t\tfor (const [t, p] of CHAR_PATTERNS) {\n\t\t\t\tif (p.test(c)) return t;\n\t\t\t}\n\t\t\treturn 'O';\n\t\t}\n\t\t\n\t\t\n\t\t// -----------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tconst PAIRS = {\n\t\t\t'*S': -1, 'S*': 2,\n\t\t\t'*E': 2,\n\t\t\t'*T': 99, 'T*': -99,\n\t\t\t'*V': -1, 'V*': -1,\n\t\t\t'II': 1, 'KK': 1, 'HH': 1,  'NN': 1, 'OO': 1, 'TT': 1,\n\t\t\t'HI': 1,\n\t\t\t'NH': 2, 'NK': 1, 'NI': 1,\n\t\t\t'ON': 1, 'NO': 1,\n\t\t};\n\t\t\n\t\tfunction weightByCharTypes(ts, ws) {\n\t\t\tfor (let i = 1; i < ts.length; i += 1) {\n\t\t\t\tconst t0 = ts[i - 1];\n\t\t\t\tconst t1 = ts[i];\n\t\t\t\tws[i] += (PAIRS[t0 + t1] ?? 0) + (PAIRS['*' + t1] ?? 0) + (PAIRS[t0 + '*'] ?? 0);\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\t// -----------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction divideByPhrases(strA, ws, phrases) {\n\t\t\tfor (const ph of phrases) {\n\t\t\t\tconst phA = Array.from(ph);\n\t\t\t\tconst phL = phA.length;\n\t\t\n\t\t\t\tfor (let bgn = 0;;) {\n\t\t\t\t\tconst idx0 = indexOfArray(strA, phA, bgn);\n\t\t\t\t\tif (idx0 === -1) break;\n\t\t\t\t\tconst idx1 = idx0 + phL;\n\t\t\n\t\t\t\t\tws[idx0] -= phL;\n\t\t\t\t\tfor (let i = 1; i < phL; i += 1) ws[idx0 + i] += phL;\n\t\t\t\t\tbgn = idx1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction divideByCombinedPhrases(strA, ws, phrases, al) {\n\t\t\tfor (const ph of phrases) {\n\t\t\t\tconst phA = Array.from(ph);\n\t\t\t\tconst phL = phA.length;\n\t\t\n\t\t\t\tfor (let bgn = 0;;) {\n\t\t\t\t\tconst idx0 = indexOfArray(strA, phA, bgn);\n\t\t\t\t\tif (idx0 === -1) break;\n\t\t\t\t\tconst idx1 = idx0 + phL;\n\t\t\n\t\t\t\t\tws[idx0 + al] -= phL - al;\n\t\t\t\t\tfor (let i = 1; i < phL - al; i += 1) ws[idx0 + al + i] += phL - al;\n\t\t\t\t\tbgn = idx1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction concatByPhrases(strA, ws, phrases) {\n\t\t\tfor (const ph of phrases) {\n\t\t\t\tconst phA = Array.from(ph);\n\t\t\t\tconst phL = phA.length;\n\t\t\n\t\t\t\tfor (let bgn = 0; ;) {\n\t\t\t\t\tconst idx0 = indexOfArray(strA, phA, bgn);\n\t\t\t\t\tif (idx0 === -1) break;\n\t\t\t\t\tconst idx1 = idx0 + phL;\n\t\t\n\t\t\t\t\tws[idx0] += phL;\n\t\t\t\t\tfor (let i = 1; i < phL; i += 1) ws[idx0 + i] += phL;\n\t\t\t\t\tbgn = idx1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction weightByPhrases(strA, ts, ws, phrases, prevCts, nextCts, prevW, nextW) {\n\t\t\tconst tsL = ts.length;\n\t\t\n\t\t\tfor (const ph of phrases) {\n\t\t\t\tconst phA = Array.from(ph);\n\t\t\t\tconst phL = phA.length;\n\t\t\n\t\t\t\tfor (let bgn = 0; ;) {\n\t\t\t\t\tconst idx0 = indexOfArray(strA, phA, bgn);\n\t\t\t\t\tif (idx0 === -1) break;\n\t\t\t\t\tconst idx1 = idx0 + phL;\n\t\t\n\t\t\t\t\tif (\n\t\t\t\t\t\t(idx0 === 0   || (idx0 !== 0 && prevCts.includes(ts[idx0 - 1]))) &&\n\t\t\t\t\t\t(idx1 === tsL || (idx1 < tsL && nextCts.includes(ts[idx1])))\n\t\t\t\t\t) {\n\t\t\t\t\t\tws[idx0] += prevW;\n\t\t\t\t\t\tif (idx1 < ws.length) ws[idx1] += nextW;\n\t\t\t\t\t\tfor (let i = 1; i < phL; i += 1) ws[idx0 + i] += phL;\n\t\t\t\t\t}\n\t\t\t\t\tbgn = idx1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction indexOfArray(array, searchElement, fromIndex = 0) {\n\t\t\tif (array === null || array === undefined) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tif (array.length === 0) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tfor (let i = fromIndex; i < array.length - searchElement.length + 1; i += 1) {\n\t\t\t\tlet match = true;\n\t\t\n\t\t\t\tfor (let j = 0; j < searchElement.length; j += 1) {\n\t\t\t\t\tif (array[i + j] !== searchElement[j]) {\n\t\t\t\t\t\tmatch = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (match) {\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn -1;\n\t\t}\n\t\t\n\t\t\n\t\t// -----------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction createFragment(str, ts, ws, opts) {\n\t\t\tconst df = document.createDocumentFragment();\n\t\t\tlet temp = '';\n\t\t\tlet bgn  = 0;\n\t\t\n\t\t\tlet idx = 0;\n\t\t\tfor (const c of str) {\n\t\t\t\tif (ws[idx] <= 0) {\n\t\t\t\t\tconst isOrig = isOriginalCharPhrase(ts, bgn, idx);\n\t\t\t\t\tappendPhrase(df, temp, isOrig, opts.styleSegment);\n\t\t\t\t\ttemp = '';\n\t\t\t\t\tbgn  = idx;\n\t\t\t\t}\n\t\t\t\ttemp += c;\n\t\t\t\tidx  += 1;\n\t\t\t}\n\t\t\tif (temp.length) {\n\t\t\t\tconst isOrig = isOriginalCharPhrase(ts, bgn, ts.length);\n\t\t\t\tappendPhrase(df, temp, isOrig, opts.styleSegment);\n\t\t\t}\n\t\t\treturn df;\n\t\t}\n\t\t\n\t\tfunction appendPhrase(df, str, isOrig, style) {\n\t\t\tif (isOrig) {\n\t\t\t\tdf.appendChild(document.createTextNode(str));\n\t\t\t} else {\n\t\t\t\tconst e = document.createElement('span');\n\t\t\t\te.appendChild(document.createTextNode(str));\n\t\t\t\tif (style.length) setClass(e, style);\n\t\t\t\tdf.appendChild(e);\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction isOriginalCharPhrase(ts, bgn, end) {\n\t\t\tfor (let i = bgn; i < end; i += 1) {\n\t\t\t\tconst t = ts[i];\n\t\t\t\tif (!CLS_ORIG.includes(t)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\t\n\t\tNS.jaSegmenter      = initialize;\n\t\tNS.jaApplySegmenter = apply;\n\t})();\n\n\t/**\n\t *\n\t * Utilities\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-11-03\n\t *\n\t */\n\t\n\t\n\tfunction hasClass(tar, cls) {\n\t\tconst key = cls.substr(1);\n\t\tif (cls.startsWith(':')) {\n\t\t\treturn tar.dataset[key] !== undefined;\n\t\t} else {\n\t\t\treturn tar.classList.contains(key);\n\t\t}\n\t}\n\t\n\tfunction setClass(tar, cls, enabled = true, val = '') {\n\t\tconst key = cls.substr(1);\n\t\tif (cls.startsWith(':')) {\n\t\t\tif (enabled) {\n\t\t\t\ttar.dataset[key] = val;\n\t\t\t} else {\n\t\t\t\tdelete tar.dataset[key];\n\t\t\t}\n\t\t} else {\n\t\t\tif (enabled) {\n\t\t\t\ttar.classList.add([key, val].join('-'));\n\t\t\t} else {\n\t\t\t\ttar.classList.remove([key, val].join('-'));\n\t\t\t}\n\t\t}\n\t}\n\t\n\t/**\n\t *\n\t * Common Functions\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-11-03\n\t *\n\t */\n\t\n\t\n\tfunction removeHeadWhiteSpaces(str) {\n\t\tconst mzs = str.match(/^[\\n\\r\\t ]*(\\u3000*)/);\n\t\tconst zs = (mzs && 1 < mzs.length) ? mzs[1] : '';\n\t\treturn zs + str.replace(/^\\s+/g, '');  // Trim left\n\t}\n\t\n\tfunction removeTailWhiteSpaces(str) {\n\t\treturn str.replace(/\\s+$/g, '');  // Trim right\n\t}\n\t\n\tfunction removeWhiteSpacesBetweenZenChars(str) {\n\t\t// White space character class excluding \\u3000\n\t\t// [ \\f\\n\\r\\t\\v​\\u00a0​\\u180e\\u2000​-\\u200a​\\u2028\\u2029\\u202f\\u205f​\\ufeff]\n\t\treturn str.replace(/([^\\x01-\\x7E\\xA1-\\xDF]+)([\\t\\n]+|[ \\f\\n\\r\\t\\v\\u00a0\\u180e\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\ufeff]{2})([^\\x01-\\x7E\\xA1-\\xDF]+)/g, (match, g1, d, g2) => g1 + g2);\n\t}\n\t\n\n})(window['NACSS']);\n"]}